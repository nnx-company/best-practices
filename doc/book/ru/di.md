# Управление зависимостями

Существует три термина, часто встречающихся когда речь заходит про управление зависимостями.

* IoC - Inversion of Control(Инверсия управления)
* DIP - Dependency Inversion Principle (Принцип инверсии зависимостей)
* DI - Dependency Injection (Внедрение зависимостей)

Рассмотрим каждый из этих терминов отдельно.

# IoC - Inversion of Control(Инверсия управления)

Суть термина инверсия управления сводится к тому что, разрабатываемый компонет, предоставляет некоторые точки расширения,
через которые он вызывает определенные методы пользовательского кода.

Примером IoC может служить то как работает [приложение в zf](https://github.com/zendframework/zend-mvc/blob/release-3.0.2/src/Application.php#L292).
Роутинг, вызов кода контроллера, и окончание обработки запроса, встроенны не в само приложение, а делегированны внешнему
окружению.

# DIP - Dependency Inversion Principle (Принцип инверсии зависимостей)

Это принцип проектирования, который описывается двумя правилами

* Модули верхнего уровня не должны зависеть от модулей нижнего уровня. И те и другие должны зависеть от абстракций.
* Абстракции не должны зависеть от деталей. Детали должны зависеть от абстракций.

Реализацией данного принципа, является то, что компонент не создает внутри себя зависимые объекты, а требует их у более
высокоуровневых компонентов - либо через аргументы метода, либо через аргументы конструктора. При этом зависимость должна
декларироваться, не как конкретный класс, а в виде интерфейса. 

При разработке соблюдение принципа DIP - в чистом виде *НЕ ВОЗМОЖНО*, в противном случае, это приведет к бездумному
созданию интерфейсов. Т.е. при проектирование реальных систем, принцип "Зависить надо от абстракций", неизбежно будет 
нарушаться.

Когда следует создавать интерфейсы:

* Класс реализует паттерн "стратегия"
* Реализация класса работает с внешним окружением (файлами, сокетами, конфигурацией и т.п.).
* Класс находится на стыке модулей

Когда *НЕ* следует создавать интерфейсы:

* Класс является неизменяемым «объектом-значением» (Value Object) или объектом-данных (Data Object)
* Класс обладает стабильным поведением (не работает с внешним окружением)

Применение принципов DIP на практике, сводится к следующим рекомендациям:

* Важные зависимости должны быть явными (передоваться через констуктор)
* Число зависимостей должно быть минимально, если класс может о чем то не знать, то лучше избавить его от лишней информации
* Выделяйте стратегии, пусть класс имеет зависимость обозначенную интерфейсом стратегии. 
* Объекты значения  (Value Objects), и функции без побочных эффектов, не требуют интерфейсов








